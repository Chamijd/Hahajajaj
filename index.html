<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>සුභ උපන් දිනයක්!</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Animate.css for animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@400;700&display=swap');
        
        :root {
            --primary: #d946ef;
            --secondary: #7e22ce;
            --accent: #f43f5e;
        }
        
        body {
            font-family: 'Noto Sans Sinhala', sans-serif;
            background: linear-gradient(135deg, #fbcfe8, var(--primary), var(--secondary));
            background-size: 300% 300%;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            animation: gradientBG 15s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Hide all sections initially */
        section {
            display: none;
            max-width: 800px;
            width: 90%;
            margin: 0 auto;
        }

        /* Welcome Section */
        #welcomeSection {
            text-align: center;
        }

        /* Gift Section */
        .gift-box {
            width: 220px;
            height: 220px;
            background: linear-gradient(135deg, var(--accent), var(--primary));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin: 0 auto;
            box-shadow: 0 15px 35px rgba(216, 70, 239, 0.5);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
        }

        .gift-box:hover {
            transform: scale(1.08) rotate(5deg);
            box-shadow: 0 20px 45px rgba(216, 70, 239, 0.7);
        }

        .gift-box::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                transparent 0%,
                rgba(255,255,255,0.1) 45%,
                rgba(255,255,255,0.15) 50%,
                rgba(255,255,255,0.1) 55%,
                transparent 100%
            );
            transform: rotate(30deg);
            animation: giftShine 3s infinite;
        }

        @keyframes giftShine {
            0% { transform: translateX(-100%) rotate(30deg); }
            100% { transform: translateX(100%) rotate(30deg); }
        }

        /* Name Input Section */
        #nameInputSection {
            background: white;
            padding: 2.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            text-align: center;
        }

        /* Message Section */
        #messageSection {
            background: rgba(255,255,255,0.92);
            padding: 2.5rem;
            border-radius: 1.5rem;
            backdrop-filter: blur(12px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            text-align: center;
        }

        /* Advanced Gallery Section */
        .gallery-container {
            position: relative;
            width: 100%;
            height: 450px;
            perspective: 1200px;
            margin: 2.5rem auto;
        }

        .gallery-slider {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .gallery-slide {
            position: absolute;
            width: 320px;
            height: 320px;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.25);
            transition: all 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            filter: brightness(0.8) saturate(0.8);
            opacity: 0.8;
            z-index: 1;
        }

        .gallery-slide.active {
            transform: translate(-50%, -50%) scale(1.15) rotateY(0deg);
            filter: brightness(1.1) saturate(1.1);
            opacity: 1;
            z-index: 3;
            box-shadow: 0 25px 60px rgba(0,0,0,0.35);
        }

        .gallery-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .gallery-slide.active img {
            transform: scale(1.08);
        }

        /* Loading Animation */
        .loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .loader-content {
            text-align: center;
            color: white;
            margin-top: 30px;
        }

        .loader-spinner {
            position: relative;
            width: 100px;
            height: 100px;
        }

        .loader-spinner div {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 10px solid transparent;
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 2s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
        }

        .loader-spinner div:nth-child(2) {
            border: 10px solid transparent;
            border-bottom-color: var(--secondary);
            animation: spinReverse 2s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
        }

        .loader-spinner div:nth-child(3) {
            width: 70%;
            height: 70%;
            top: 15%;
            left: 15%;
            border: 8px solid transparent;
            border-left-color: var(--accent);
            animation: spin 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite reverse;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes spinReverse {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-360deg); }
        }

        /* Beautiful Buttons */
        .btn {
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transform: translateY(0);
            position: relative;
            overflow: hidden;
            border: none;
            font-weight: bold;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            border-radius: 12px;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            cursor: pointer;
        }

        .btn:hover {
            transform: translateY(-7px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.25);
        }

        .btn:active {
            transform: translateY(3px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.8s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        /* Floating Action Button */
        .fab {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: fixed;
            bottom: 40px;
            right: 40px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.25);
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 100;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .fab:hover {
            transform: scale(1.15) translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        /* Input Field */
        .input-field {
            width: 100%;
            padding: 1.2rem;
            border: 2px solid #e9d5ff;
            border-radius: 12px;
            font-size: 1.1rem;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            background: rgba(255,255,255,0.9);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(216, 70, 239, 0.2);
            transform: translateY(-3px);
        }

        /* Animations */
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-25px) rotate(5deg); }
        }

        .animate-pulse {
            animation: pulse 2.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.08); opacity: 0.9; }
            100% { transform: scale(1); opacity: 1; }
        }

        .animate-bounce {
            animation: bounce 2.5s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .animate-fade-in {
            animation: fadeIn 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-slide-in {
            animation: slideIn 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-80px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .gallery-container {
                height: 350px;
                perspective: 1000px;
            }
            
            .gallery-slide {
                width: 280px;
                height: 280px;
            }
            
            .fab {
                width: 60px;
                height: 60px;
                bottom: 30px;
                right: 30px;
            }
        }
    </style>
</head>
<body>
    <!-- Advanced Loading Screen -->
    <div id="loader" class="loader">
        <div class="loader-spinner">
            <div></div>
            <div></div>
            <div></div>
        </div>
        <div class="loader-content">
            <h2 class="text-3xl font-bold mb-4 animate-pulse">පූජා ලබනවා...</h2>
            <p class="text-xl" id="loadingText">ඔබේ විශේෂ උපන්දින තෑග්ග සූදානම් වෙමින් පවතී</p>
        </div>
    </div>

    <!-- Confetti Container -->
    <div id="confettiContainer"></div>

    <!-- Floating Hearts Container -->
    <div id="heartsContainer"></div>

    <!-- Floating Music Button -->
    <div id="musicBtn" class="fab animate__animated animate__bounceIn">
        <i class="fas fa-music text-2xl"></i>
    </div>

    <!-- Welcome Section -->
    <section id="welcomeSection" class="animate__animated animate__fadeIn">
        <div class="animate-slide-in">
            <h1 class="text-5xl font-bold text-white mb-8 animate-pulse">සුභ උපන් දිනයක්!</h1>
            <p class="text-white text-2xl mb-10">මෙම විශේෂ තෑග්ග විවෘත කිරීමට පහත බොත්තම ක්ලික් කරන්න</p>
            <button id="startBtn" class="btn btn-primary px-10 py-5 text-xl animate-float">
                <i class="fas fa-gift mr-3"></i> ආරම්භ කරන්න
            </button>
        </div>
    </section>

    <!-- Gift Section -->
    <section id="giftSection">
        <div class="text-center animate-fade-in">
            <div id="giftBox" class="gift-box animate-bounce">
                <i class="fas fa-gift text-7xl text-white"></i>
            </div>
            <p class="text-white mt-8 text-2xl">තෑග්ග ක්ලික් කර විවෘත කරන්න!</p>
        </div>
    </section>

    <!-- Name Input Section -->
    <section id="nameInputSection">
        <div class="animate-slide-in">
            <h2 class="text-3xl font-bold text-purple-700 mb-8">ඔබේ ලස්සන නම කුමක්ද?</h2>
            <input type="text" id="userName" placeholder="මෙතන ටයිප් කරන්න" 
                   class="input-field mb-8">
            <button id="submitNameBtn" class="btn btn-primary w-full py-5 text-xl">
                <i class="fas fa-arrow-right mr-3"></i> ඉදිරියට යන්න
            </button>
        </div>
    </section>

    <!-- Message Section -->
    <section id="messageSection">
        <div class="animate-fade-in">
            <h1 id="greeting" class="text-4xl font-bold text-purple-700 mb-8"></h1>
            <p id="message" class="text-xl text-gray-700 mb-10 leading-relaxed"></p>
            <button id="nextMessageBtn" class="btn btn-secondary px-10 py-4 text-xl">
                <i class="fas fa-forward mr-3"></i> ඊළඟ පණිවිඩය
            </button>
            <button id="showGalleryBtn" class="btn btn-success px-10 py-4 text-xl mt-6 hidden">
                <i class="fas fa-images mr-3"></i> ඡායාරූප බලන්න
            </button>
        </div>
    </section>

    <!-- Advanced Gallery Section -->
    <section id="gallerySection" class="bg-white p-8 rounded-2xl shadow-2xl">
        <div class="animate-slide-in">
            <h1 class="text-4xl font-bold text-purple-700 mb-10 text-center">ඔබේ මතකයන්</h1>
            
            <div class="gallery-container">
                <div id="gallerySlider" class="gallery-slider">
                    <!-- Slides will be added dynamically -->
                </div>
            </div>
            
            <div class="flex justify-center space-x-6 mt-8">
                <button id="prevBtn" class="btn btn-primary w-16 h-16 rounded-full text-xl">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button id="pauseBtn" class="btn btn-danger w-16 h-16 rounded-full text-xl">
                    <i class="fas fa-pause"></i>
                </button>
                <button id="nextBtn" class="btn btn-primary w-16 h-16 rounded-full text-xl">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
            <div class="text-center mt-10">
                <button id="backToMessageBtn" class="btn btn-secondary px-10 py-4 text-xl">
                    <i class="fas fa-arrow-left mr-3"></i> පණිවිඩයට ආපසු යන්න
                </button>
            </div>
        </div>
    </section>

    <!-- Background Music -->
    <audio id="backgroundMusic" loop>
        <source src="https://files.catbox.moe/azng1e.mp3" type="audio/mpeg">
    </audio>

    <script>
        // DOM Elements
        const welcomeSection = document.getElementById('welcomeSection');
        const giftSection = document.getElementById('giftSection');
        const nameInputSection = document.getElementById('nameInputSection');
        const messageSection = document.getElementById('messageSection');
        const gallerySection = document.getElementById('gallerySection');
        const loader = document.getElementById('loader');
        const musicBtn = document.getElementById('musicBtn');
        const loadingText = document.getElementById('loadingText');
        
        const startBtn = document.getElementById('startBtn');
        const giftBox = document.getElementById('giftBox');
        const submitNameBtn = document.getElementById('submitNameBtn');
        const nextMessageBtn = document.getElementById('nextMessageBtn');
        const showGalleryBtn = document.getElementById('showGalleryBtn');
        const backToMessageBtn = document.getElementById('backToMessageBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        
        const greeting = document.getElementById('greeting');
        const message = document.getElementById('message');
        const userNameInput = document.getElementById('userName');
        
        const backgroundMusic = document.getElementById('backgroundMusic');
        const confettiContainer = document.getElementById('confettiContainer');
        const heartsContainer = document.getElementById('heartsContainer');
        const gallerySlider = document.getElementById('gallerySlider');
        
        // Messages
        const messages = [
            "ඔබේ ජීවිතයේ සෑම මොහොතක්ම ප්‍රීතිමත්, සතුටුදායක හා ආශ්චර්යමත් වේවා!",
            "ඔබේ සිහිල් හා මිහිරි සිනහවෙන් ලොව ආලෝකමත් වේවා!",
            "ඔබේ සිහිල් මනස, ගොඩක් ආදරය සහ ලස්සන හැඩය ඔබේ විශේෂ ගුණාංගයි!",
            "අලංකාර අනාගතයක් ඔබ වෙනුවෙන් බලාපොරොත්තු වෙමි!",
            "ඔබේ උපන් දිනයෙන් පටන් ගත් මේ නව වසර ඔබට සුභ පතමි!"
        ];
        
        // Image URLs
        const images = [
            "https://files.catbox.moe/cpu3eu.jpg",
            "https://files.catbox.moe/5dar3f.jpg",
            "https://files.catbox.moe/nparpu.jpg",
            "https://files.catbox.moe/ady2vu.jpg"
        ];
        
        let currentMessageIndex = 0;
        let userName = '';
        let currentSlideIndex = 0;
        let autoRotateInterval;
        let isAutoRotating = true;
        let rotationSpeed = 3500; // 3.5 seconds per slide
        let isMusicPlaying = false;
        
        // Show loading screen with progress
        function showLoading() {
            loader.style.display = 'flex';
            
            let loadedImages = 0;
            const totalImages = images.length;
            const loadingMessages = [
                "තෑග්ග සූදානම් කරමින්...",
                "පණිවිඩ ලබා ගැනීම...",
                "රූප සැකසීම...",
                "ඇනිමේෂන් සකස් කිරීම...",
                "සියල්ල සූදානම්!"
            ];
            
            // Preload images
            images.forEach((imgUrl, index) => {
                const img = new Image();
                img.src = imgUrl;
                img.onload = () => {
                    loadedImages++;
                    const percent = Math.round((loadedImages / totalImages) * 100);
                    
                    // Update loading message based on progress
                    let messageIndex = Math.floor((loadedImages / totalImages) * loadingMessages.length);
                    if (messageIndex >= loadingMessages.length) messageIndex = loadingMessages.length - 1;
                    
                    loadingText.innerHTML = `${loadingMessages[messageIndex]} <span class="font-bold">${percent}%</span>`;
                    
                    if(loadedImages === totalImages) {
                        setTimeout(() => {
                            loader.style.opacity = '0';
                            setTimeout(() => {
                                loader.style.display = 'none';
                                welcomeSection.style.display = 'block';
                                
                                // Animate welcome section elements sequentially
                                const welcomeElements = welcomeSection.querySelectorAll('*');
                                welcomeElements.forEach((el, i) => {
                                    setTimeout(() => {
                                        el.classList.add('animate__animated', 'animate__fadeInUp');
                                    }, i * 200);
                                });
                            }, 500);
                        }, 500);
                    }
                };
            });
        }
        
        // Initialize gallery
        function initGallery() {
            images.forEach((img, index) => {
                const slide = document.createElement('div');
                slide.className = 'gallery-slide';
                
                const imgElement = document.createElement('img');
                imgElement.src = img;
                imgElement.alt = `Image ${index + 1}`;
                
                slide.appendChild(imgElement);
                gallerySlider.appendChild(slide);
                
                // Position slides in a circle
                const angle = (360 / images.length) * index;
                const radius = 500;
                const x = radius * Math.sin(angle * Math.PI / 180);
                const z = radius * Math.cos(angle * Math.PI / 180);
                
                slide.style.transform = `translate(-50%, -50%) rotateY(${angle}deg) translateZ(${z}px) translateX(${x}px)`;
            });
            
            updateGallery();
            startAutoRotation();
        }
        
        // Update gallery
        function updateGallery() {
            const angle = (360 / images.length) * currentSlideIndex;
            gallerySlider.style.transform = `rotateY(${-angle}deg)`;
            
            // Update active class with animation
            const slides = document.querySelectorAll('.gallery-slide');
            slides.forEach((slide, index) => {
                if(index === currentSlideIndex) {
                    slide.classList.add('active');
                    
                    // Add bounce animation to active image
                    slide.style.animation = 'none';
                    void slide.offsetHeight; // Trigger reflow
                    slide.style.animation = 'bounce 2.5s infinite';
                } else {
                    slide.classList.remove('active');
                    slide.style.animation = 'none';
                }
            });
        }
        
        // Next slide with animation
        function nextSlide() {
            currentSlideIndex = (currentSlideIndex + 1) % images.length;
            updateGallery();
            
            // Add click animation
            nextBtn.style.transform = 'scale(0.9)';
            setTimeout(() => {
                nextBtn.style.transform = 'scale(1)';
            }, 300);
        }
        
        // Previous slide with animation
        function prevSlide() {
            currentSlideIndex = (currentSlideIndex - 1 + images.length) % images.length;
            updateGallery();
            
            // Add click animation
            prevBtn.style.transform = 'scale(0.9)';
            setTimeout(() => {
                prevBtn.style.transform = 'scale(1)';
            }, 300);
        }
        
        // Start auto rotation
        function startAutoRotation() {
            if(autoRotateInterval) clearInterval(autoRotateInterval);
            isAutoRotating = true;
            pauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            
            autoRotateInterval = setInterval(() => {
                if(isAutoRotating) {
                    nextSlide();
                }
            }, rotationSpeed);
        }
        
        // Toggle auto rotation with animation
        function toggleAutoRotation() {
            isAutoRotating = !isAutoRotating;
            pauseBtn.innerHTML = isAutoRotating ? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play"></i>';
            
            // Add click animation
            pauseBtn.style.transform = 'scale(0.9)';
            setTimeout(() => {
                pauseBtn.style.transform = 'scale(1)';
            }, 300);
            
            if(isAutoRotating && !autoRotateInterval) {
                startAutoRotation();
            }
        }
        
        // Toggle music with animation
        function toggleMusic() {
            isMusicPlaying = !isMusicPlaying;
            
            if(isMusicPlaying) {
                backgroundMusic.play();
                musicBtn.innerHTML = '<i class="fas fa-volume-up text-2xl"></i>';
                
                // Add pulse animation
                musicBtn.style.animation = 'pulse 2s infinite';
            } else {
                backgroundMusic.pause();
                musicBtn.innerHTML = '<i class="fas fa-volume-mute text-2xl"></i>';
                
                // Remove pulse animation
                musicBtn.style.animation = 'none';
            }
            
            // Add click animation
            musicBtn.style.transform = 'scale(0.9)';
            setTimeout(() => {
                musicBtn.style.transform = 'scale(1)';
            }, 300);
        }
        
        // Create confetti with different shapes
        function createConfetti(count = 150) {
            const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4CAF50', '#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107', '#FF9800', '#FF5722'];
            const shapes = ['❤️', '✨', '🎉', '🎊', '🌟', '💫', '🌸', '💖'];
            
            for(let i = 0; i < count; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * window.innerWidth + 'px';
                confetti.style.top = -30 + 'px';
                confetti.style.color = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.fontSize = Math.random() * 20 + 15 + 'px';
                
                // Randomly choose between shape or colored div
                if(Math.random() > 0.5) {
                    confetti.textContent = shapes[Math.floor(Math.random() * shapes.length)];
                } else {
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = Math.random() * 15 + 8 + 'px';
                    confetti.style.height = Math.random() * 15 + 8 + 'px';
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                }
                
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                confetti.style.zIndex = '9998';
                
                confettiContainer.appendChild(confetti);
                
                const animationDuration = Math.random() * 3 + 2;
                const delay = Math.random() * 2;
                
                const keyframes = [
                    { top: -30 + 'px', opacity: 1, transform: `rotate(${Math.random() * 360}deg)` },
                    { top: window.innerHeight + 'px', opacity: 0, transform: `rotate(${Math.random() * 360}deg)` }
                ];
                
                const options = {
                    duration: animationDuration * 1000,
                    delay: delay * 1000,
                    easing: 'cubic-bezier(0.1, 0.8, 0.9, 1)'
                };
                
                confetti.animate(keyframes, options);
                
                setTimeout(() => {
                    confetti.remove();
                }, (animationDuration + delay) * 1000);
            }
        }
        
        // Create floating hearts with different sizes and speeds
        function createHearts() {
            const heartColors = ['#ff0000', '#ff69b4', '#ff1493', '#ff00ff', '#ff00cc'];
            
            setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'heart';
                heart.innerHTML = '<i class="fas fa-heart"></i>';
                heart.style.left = Math.random() * window.innerWidth + 'px';
                heart.style.top = window.innerHeight + 30 + 'px';
                heart.style.color = heartColors[Math.floor(Math.random() * heartColors.length)];
                heart.style.fontSize = Math.random() * 25 + 15 + 'px';
                
                // Random animation duration
                const duration = Math.random() * 4 + 4;
                heart.style.animation = `float ${duration}s ease-in-out infinite`;
                
                heartsContainer.appendChild(heart);
                
                setTimeout(() => {
                    heart.remove();
                }, duration * 1000);
            }, 300);
        }
        
        // Button click animation
        function animateButton(button) {
            button.style.transform = 'scale(0.95)';
            button.style.boxShadow = '0 2px 10px rgba(0,0,0,0.2)';
            
            setTimeout(() => {
                button.style.transform = '';
                button.style.boxShadow = '';
            }, 300);
        }
        
        // Initialize the page
        function init() {
            showLoading();
            initGallery();
            
            // Add click animations to all buttons
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', function() {
                    animateButton(this);
                    
                    // Play click sound
                    const clickSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3');
                    clickSound.volume = 0.3;
                    clickSound.play();
                });
            });
        }
        
        // Event Listeners with animations
        startBtn.addEventListener('click', function() {
            welcomeSection.style.animation = 'fadeOut 0.8s ease';
            
            setTimeout(() => {
                welcomeSection.style.display = 'none';
                giftSection.style.display = 'block';
                giftSection.style.animation = 'fadeIn 0.8s ease';
            }, 800);
        });
        
        giftBox.addEventListener('click', function() {
            this.style.animation = 'rubberBand 1s';
            
            // Play gift sound
            const giftSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3');
            giftSound.play();
            
            setTimeout(() => {
                giftSection.style.animation = 'fadeOut 0.8s ease';
                
                setTimeout(() => {
                    giftSection.style.display = 'none';
                    nameInputSection.style.display = 'block';
                    nameInputSection.style.animation = 'fadeIn 0.8s ease';
                    userNameInput.focus();
                }, 800);
            }, 1000);
        });
        
        submitNameBtn.addEventListener('click', function() {
            userName = userNameInput.value.trim();
            
            if(userName) {
                // Add loading effect
                const originalContent = this.innerHTML;
                this.innerHTML = '<i class="fas fa-spinner fa-spin mr-3"></i> පූජා ලබනවා...';
                this.disabled = true;
                
                setTimeout(() => {
                    nameInputSection.style.animation = 'fadeOut 0.8s ease';
                    
                    setTimeout(() => {
                        nameInputSection.style.display = 'none';
                        messageSection.style.display = 'block';
                        messageSection.style.animation = 'fadeIn 0.8s ease';
                        
                        // Set greeting
                        greeting.textContent = `සුභ උපන් දිනයක්, ${userName}!`;
                        message.textContent = messages[currentMessageIndex];
                        
                        // Play background music
                        backgroundMusic.volume = 0.3;
                        toggleMusic();
                        
                        // Create floating hearts
                        createHearts();
                        
                        // Reset button
                        this.innerHTML = originalContent;
                        this.disabled = false;
                    }, 800);
                }, 800);
            } else {
                userNameInput.style.animation = 'shakeX 0.8s';
                setTimeout(() => {
                    userNameInput.style.animation = '';
                }, 800);
            }
        });
        
        nextMessageBtn.addEventListener('click', function() {
            currentMessageIndex++;
            
            if(currentMessageIndex < messages.length) {
                // Add loading effect
                const originalContent = this.innerHTML;
                this.innerHTML = '<i class="fas fa-spinner fa-spin mr-3"></i> පූජා ලබනවා...';
                this.disabled = true;
                
                setTimeout(() => {
                    message.style.animation = 'fadeOut 0.8s ease';
                    
                    setTimeout(() => {
                        message.textContent = messages[currentMessageIndex];
                        message.style.animation = 'fadeIn 0.8s ease';
                        
                        // Show confetti for some messages
                        if(currentMessageIndex % 2 === 0) {
                            createConfetti();
                        }
                        
                        // Show gallery button on last message
                        if(currentMessageIndex === messages.length - 1) {
                            showGalleryBtn.classList.remove('hidden');
                            showGalleryBtn.style.animation = 'pulse 2s infinite';
                        }
                        
                        // Reset button
                        this.innerHTML = originalContent;
                        this.disabled = false;
                    }, 800);
                }, 800);
            }
        });
        
        showGalleryBtn.addEventListener('click', function() {
            // Add loading effect
            const originalContent = this.innerHTML;
            this.innerHTML = '<i class="fas fa-spinner fa-spin mr-3"></i> පූජා ලබනවා...';
            this.disabled = true;
            
            setTimeout(() => {
                messageSection.style.animation = 'fadeOut 0.8s ease';
                
                setTimeout(() => {
                    messageSection.style.display = 'none';
                    gallerySection.style.display = 'block';
                    gallerySection.style.animation = 'fadeIn 0.8s ease';
                    
                    // Create more confetti
                    createConfetti(200);
                    
                    // Reset auto rotation
                    startAutoRotation();
                    
                    // Reset button
                    this.innerHTML = originalContent;
                    this.disabled = false;
                }, 800);
            }, 800);
        });
        
        backToMessageBtn.addEventListener('click', function() {
            gallerySection.style.animation = 'fadeOut 0.8s ease';
            
            setTimeout(() => {
                gallerySection.style.display = 'none';
                messageSection.style.display = 'block';
                messageSection.style.animation = 'fadeIn 0.8s ease';
            }, 800);
        });
        
        // Gallery Navigation
        nextBtn.addEventListener('click', nextSlide);
        prevBtn.addEventListener('click', prevSlide);
        pauseBtn.addEventListener('click', toggleAutoRotation);
        
        // Music Button
        musicBtn.addEventListener('click', toggleMusic);
        
        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if(gallerySection.style.display === 'block') {
                if(e.key === 'ArrowRight') {
                    nextSlide();
                } else if(e.key === 'ArrowLeft') {
                    prevSlide();
                } else if(e.key === ' ' || e.key === 'Spacebar') {
                    toggleAutoRotation();
                }
            }
        });
        
        // Initialize the page
        init();
    </script>
</body>
</html>
